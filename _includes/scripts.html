<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32627981-1']);
  _gaq.push(['_setDomainName', 'tdub.co']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script type="text/javascript">
  window.tdub = {
    init: function(){
      this.setHrefTargets()
      this.setWordsPerMinute()
      this.trackAjaxPageViews()
      this.widont()
    },

    setHrefTargets: function(){
      var links = document.links;
      for (var i = 0, linksLength = links.length; i < linksLength; i++) {
         if (links[i].hostname != window.location.hostname) {
             links[i].target = '_blank';
         }
      }
    },

    setWordsPerMinute: function(){
      var words = document.querySelector('.post')
      if(words){
        var wordCount = words.innerHTML.match(/\S+/g).length;
        var wpm = Math.round(parseInt(wordCount) / 180)
        var wpmDisplay = wpm+' min read'
        document.querySelector('.wpm').innerHTML = wpmDisplay
      }
    },

    trackAjaxPageViews: function(){
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-32627981-1']);
      _gaq.push(['_setDomainName', 'tdub.co']);
      _gaq.push(["_trackPageview", location.pathname+location.search]);
    },

    widont: function(items){
        items = document.querySelectorAll('.post p, .post-title a, h3')
        for (i=0; i < items.length; i++) {
            items[i].innerHTML = items[i].innerHTML.replace(/\s([^\s<]+)\s*$/,'&nbsp;$1')
        }
    }
  }
</script>

<script data-no-instant>
  InstantClick.on('change', function(){
    window.tdub.init();
  });
  InstantClick.init();
</script>
